<div class="local-sesdashboard-report">
    <div class="mb-3">
        <a href="{{dashboard_url}}" class="btn btn-primary">
            <i class="fa fa-arrow-left"></i> {{#str}}backtodashboard, local_sesdashboard{{/str}}
        </a>
    </div>
    
    <div class="filter-section mb-4 p-3" style="background: #f8f9fa; border-radius: 8px; border: 1px solid #dee2e6;">
        <h5 class="mb-3"><i class="fa fa-filter"></i> Filter Options</h5>
        
        <!-- Timeframe Selector (same as dashboard) -->
        <div class="timeframe-selector mb-3">
            <form method="get" action="" class="form-inline">
                <label for="timeframe" class="mr-2"><strong>Time Period:</strong></label>
                <select class="form-control mr-2" id="timeframe" name="timeframe" onchange="this.form.submit()">
                    {{#timeframeoptions}}
                    <option value="{{value}}" {{#selected}}selected{{/selected}}>{{label}}</option>
                    {{/timeframeoptions}}
                </select>
                <!-- Preserve other filter parameters -->
                {{#filters.status}}<input type="hidden" name="status" value="{{filters.status}}">{{/filters.status}}
                {{#filters.search}}<input type="hidden" name="search" value="{{filters.search}}">{{/filters.search}}
                <noscript>
                    <button type="submit" class="btn btn-secondary btn-sm">Update</button>
                </noscript>
            </form>
        </div>
        
        <!-- Main Filter Form -->
        <form action="{{baseurl}}" method="get" class="form-inline">
            <!-- Hidden timeframe field to preserve it -->
            <input type="hidden" name="timeframe" value="{{timeframe}}">
            
            <div class="form-group mr-3">
                <label for="status" class="mr-2"><strong>{{#str}}status, local_sesdashboard{{/str}}:</strong></label>
                <select name="status" id="status" class="form-control">
                    <option value="">{{#str}}all, local_sesdashboard{{/str}}</option>
                    <option value="Send" {{#filters.status_send}}selected{{/filters.status_send}}>üì§ Send</option>
                    <option value="Delivery" {{#filters.status_delivery}}selected{{/filters.status_delivery}}>‚úÖ Delivery</option>
                    <option value="Open" {{#filters.status_open}}selected{{/filters.status_open}}>üëÅÔ∏è Open</option>
                    <option value="Click" {{#filters.status_click}}selected{{/filters.status_click}}>üëÜ Click</option>
                    <option value="Bounce" {{#filters.status_bounce}}selected{{/filters.status_bounce}}>‚ùå Bounce</option>
                </select>
            </div>
            
            <div class="form-group mr-3">
                <label for="search" class="mr-2"><strong>{{#str}}search, local_sesdashboard{{/str}}:</strong></label>
                <input type="text" name="search" id="search" class="form-control" value="{{{filters.search}}}" placeholder="{{#str}}searchplaceholder, local_sesdashboard{{/str}}" style="width: 250px;">
            </div>
            
            <button type="submit" class="btn btn-primary mr-2">
                <i class="fa fa-search"></i> {{#str}}filter, local_sesdashboard{{/str}}
            </button>
            <a href="{{baseurl}}?timeframe={{timeframe}}" class="btn btn-secondary mr-2">
                <i class="fa fa-refresh"></i> {{#str}}reset, local_sesdashboard{{/str}}
            </a>
            <a href="{{downloadurl}}?status={{filters.status}}&search={{filters.search}}&from={{filters.from}}&to={{filters.to}}&timeframe={{filters.timeframe}}" class="btn btn-success" data-filters="{{filters_json}}">
                <i class="fa fa-download"></i> {{#str}}export, local_sesdashboard{{/str}}
            </a>
        </form>
        <small class="text-muted mt-2 d-block">
            <i class="fa fa-info-circle"></i> Note: Data is automatically cleaned up after 7 days. Showing data for last {{timeframe}} day(s).
        </small>
    </div>

    {{#has_results}}
    <div class="mb-3">
        <div class="alert alert-info">
            <i class="fa fa-info-circle"></i>
            {{#pagination.info}}
            Showing <strong>{{start_record}} to {{end_record}}</strong> of <strong>{{total_records}}</strong> entries
            {{/pagination.info}}
            {{^pagination.info}}
            Showing <strong>{{total_count}}</strong> entries
            {{/pagination.info}}
        </div>
    </div>
    {{/has_results}}

    <div class="table-responsive">
        <table class="table table-striped table-hover">
            <thead class="thead-dark">
                <tr>
                    <th><i class="fa fa-calendar"></i> {{#str}}date, local_sesdashboard{{/str}}</th>
                    <th><i class="fa fa-envelope"></i> {{#str}}recipient, local_sesdashboard{{/str}}</th>
                    <th><i class="fa fa-subject"></i> {{#str}}subject, local_sesdashboard{{/str}}</th>
                    <th><i class="fa fa-flag"></i> {{#str}}status, local_sesdashboard{{/str}}</th>
                    <th><i class="fa fa-cogs"></i> {{#str}}actions, local_sesdashboard{{/str}}</th>
                </tr>
            </thead>
            <tbody>
                {{#emails}}
                <tr>
                    <td>{{formatted_date}}</td>
                    <td>{{email}}</td>
                    <td>{{subject}}</td>
                    <td>
                        {{{status_badge}}}
                    </td>
                    <td>
                        {{#current_filters_query}}
                        <a href="{{baseurl}}?action=view&id={{id}}&{{current_filters_query}}" class="btn btn-sm btn-outline-info">
                            <i class="fa fa-eye"></i> {{#str}}viewdetails, local_sesdashboard{{/str}}
                        </a>
                        {{/current_filters_query}}
                        {{^current_filters_query}}
                        <a href="{{baseurl}}?action=view&id={{id}}" class="btn btn-sm btn-outline-info">
                            <i class="fa fa-eye"></i> {{#str}}viewdetails, local_sesdashboard{{/str}}
                        </a>
                        {{/current_filters_query}}
                    </td>
                </tr>
                {{/emails}}
                {{^emails}}
                <tr>
                    <td colspan="5" class="text-center text-muted py-4">
                        <i class="fa fa-inbox fa-2x mb-2"></i><br>
                        {{#str}}noemailsfound, local_sesdashboard{{/str}}
                    </td>
                </tr>
                {{/emails}}
            </tbody>
        </table>
    </div>

    {{#pagination}}
    <nav aria-label="Email report pagination">
        <ul class="pagination justify-content-center">
            {{#previous}}
            <li class="page-item">
                <a class="page-link" href="{{url}}">{{text}}</a>
            </li>
            {{/previous}}
            {{^previous}}
            <li class="page-item disabled">
                <span class="page-link">¬´ Previous</span>
            </li>
            {{/previous}}

            {{#pages}}
            <li class="page-item {{#active}}active{{/active}}">
                {{#active}}
                <span class="page-link">{{number}}</span>
                {{/active}}
                {{^active}}
                <a class="page-link" href="{{url}}">{{number}}</a>
                {{/active}}
            </li>
            {{/pages}}

            {{#next}}
            <li class="page-item">
                <a class="page-link" href="{{url}}">{{text}}</a>
            </li>
            {{/next}}
            {{^next}}
            <li class="page-item disabled">
                <span class="page-link">Next ¬ª</span>
            </li>
            {{/next}}
        </ul>
        {{#info}}
        <div class="text-center mt-2">
            <small class="text-muted">
                Page {{current_page}} of {{total_pages}} ({{total_records}} total records)
            </small>
        </div>
        {{/info}}
    </nav>
    {{/pagination}}
</div>